annotation = c("p > 0.05", "p > 0.05"), tip_length = 0.05, textsize = 6,
size = .5)
yolkplot
#eyes normalized to length (relative eye area)
morphometrics$relEye_Area_sq_mm<-morphometrics$Eye_Area_sq_mm/morphometrics$Length_mm
releyedf<-morphometrics[,c("relEye_Area_sq_mm","Days_Post_Fertilization","Treatment")]
releyeplot<-ggplot(releyedf, aes(x=Days_Post_Fertilization, y=relEye_Area_sq_mm,
fill=Treatment)) +
geom_boxplot(aes(x=Days_Post_Fertilization, y=relEye_Area_sq_mm))+
xlab(NULL)+
ylab(bquote('Eye area per length (m' *m^'2'*'/mm)'))+
coord_cartesian(ylim = c(0, 0.25), expand = TRUE) +
scale_y_continuous(breaks = seq(0, .2, by = .1))+
theme_classic(20)+
theme(legend.position="none")+
geom_signif(y_position = c(.11, .13), xmin=c(.75, 1.75), xmax = c(1.25, 2.25),
annotation = c("p < 0.01", "p < 0.001"), tip_length = 0.05, textsize = 6,
size = .5)
releyeplot
#t tests
q<-morphometrics[morphometrics$Treatment == "6PPD-Q",]
q34<-q[q$Days_Post_Fertilization == "34 DPF",]
q41<-q[q$Days_Post_Fertilization == "41 DPF",]
c<-morphometrics[morphometrics$Treatment == "Control",]
c34<-c[c$Days_Post_Fertilization == "34 DPF",]
c41<-c[c$Days_Post_Fertilization == "41 DPF",]
t.test(x=c34$Eye_Area_sq_mm, y=q34$Eye_Area_sq_mm)
t.test(x=c41$Eye_Area_sq_mm, y=q41$Eye_Area_sq_mm)
t.test(x=c34$Length_mm,y=q34$Length_mm)
t.test(x=c41$Length_mm,y=q41$Length_mm)
t.test(x=c34$Yolk_Area_sq_mm,y=q34$Yolk_Area_sq_mm)
t.test(x=c41$Yolk_Area_sq_mm,y=q41$Yolk_Area_sq_mm)
t.test(x=c34$relEye_Area_sq_mm, y=q34$relEye_Area_sq_mm)
t.test(x=c41$relEye_Area_sq_mm, y=q41$relEye_Area_sq_mm)
#display graphic
grid.arrange(yolkplot,eyeplot,lengthplot,ncol=3)
t.test(x=c34$Eye_Area_sq_mm, y=q34$Eye_Area_sq_mm)
c34<-c[c$Days_Post_Fertilization == "34 DPF",]
#t tests
q<-morphometrics[morphometrics$Treatment == "6PPDQ",]
q34<-q[q$Days_Post_Fertilization == "34",]
q41<-q[q$Days_Post_Fertilization == "41",]
c<-morphometrics[morphometrics$Treatment == "Control",]
c34<-c[c$Days_Post_Fertilization == "34",]
c41<-c[c$Days_Post_Fertilization == "41",]
t.test(x=c34$Eye_Area_sq_mm, y=q34$Eye_Area_sq_mm)
t.test(x=c41$Eye_Area_sq_mm, y=q41$Eye_Area_sq_mm)
t.test(x=c34$Length_mm,y=q34$Length_mm)
t.test(x=c41$Length_mm,y=q41$Length_mm)
t.test(x=c34$Yolk_Area_sq_mm,y=q34$Yolk_Area_sq_mm)
t.test(x=c41$Yolk_Area_sq_mm,y=q41$Yolk_Area_sq_mm)
t.test(x=c34$relEye_Area_sq_mm, y=q34$relEye_Area_sq_mm)
t.test(x=c41$relEye_Area_sq_mm, y=q41$relEye_Area_sq_mm)
#display graphic
grid.arrange(yolkplot,eyeplot,lengthplot,ncol=3)
dechor<- read.csv("data/Dechorionation_Survival.csv")
#Create survival object
dechor_surv_object <- Surv(time=dechor$Days_Post_Fertilization,
event = dechor$Outcome)
dechor_fit <- survfit(dechor_surv_object ~Treatment, data=dechor)
dechor_fit
summary(dechor_fit)
dechor_survplot <- ggsurvplot(dechor_fit, data = dechor, conf.int=TRUE,
legend=c(0.2,0.2),legend.title="Treatment",
legend.labs=c("6PPDQ Dechorionated*",
"6PPDQ Intact",
"Control Dechorionated",
"Control Intact"),
xlab = "Days post fertilization",
ggtheme=theme_classic(base_size=20))$plot
dechor_survplot
#create ggplot
dechor_ep<-data.frame(28,1)
dechor_survplot+
geom_col(aes(x=28,y=1),data=dechor_ep,fill="#D55E00",width=1,
position=position_nudge(-.5),alpha=0.2)+
scale_y_continuous(breaks=seq(0,1,by=0.5))+
scale_x_continuous(breaks=seq(27,46,by=1),labels=c("","","",30,"","","","","",
"","","","",40,"","","","",
"",""))+
geom_vline(xintercept=c(43), linetype="dotted")+
geom_label(aes(x=43,y=0.5,label="First hatch",angle=90),
size=7,fill="white")+
annotate("text",x=27.5,y=0.5,label="Exposure",angle=90,size=7)+
annotate("text",x=44.2,y=0.33,label="*",size=7)+
theme(legend.background = element_rect(fill = "transparent", color = NA))+
coord_cartesian(ylim=c(0,1),xlim=c(27,45),expand=FALSE)
#Log-rank test for differences between groups
survdiff(Surv(Days_Post_Fertilization, Outcome) ~ Treatment, data=dechor)
#Log-rank HB corrected p values for each group comparison
pairwise_survdiff(Surv(Days_Post_Fertilization, Outcome) ~ Treatment, data=dechor)
require(drc)
require(ggplot2)
require(reshape2)
require(tidyverse)
require(car)
#voights alevin
acute_data<-read.csv("data/Acute_Exposure.csv")
valevin<-acute_data[acute_data$Group=="Voights Alevin",]
valevindrc<-drm(valevin$Mortality_Rate~valevin$Measured_6PPDQ_ng_L, fct=LL.2(),type="binomial")
plot(valevindrc, confidence.level = 0.95)
summary(valevindrc)
confint(valevindrc)
predict(valevindrc, data.frame(dose=254), se.fit=TRUE)
#voights fry
fry<-acute_data[acute_data$Group=="Voights Fry",]
frydrc<-drm(fry$Mortality_Rate~fry$Measured_6PPDQ_ng_L, fct=LL.2(),type="binomial")
plot(frydrc, confidence.level = 0.95)
summary(frydrc)
confint(frydrc)
#voights parr
parr<-acute_data[acute_data$Group=="Voights Parr",]
parrdrc<-drm(parr$Mortality_Rate~parr$Measured_6PPDQ_ng_L, fct=LL.2(),type="binomial")
plot(parrdrc, confidence.level = 0.95)
summary(parrdrc)
confint(parrdrc)
#combined juvenile drc
alevinfryparr<-rbind(alevindf,frydf,parrdf)
alevinfryparrdrc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L, data=alevinfryparr,fct=LL.2(),type="binomial")
alevinfryparrsepdrc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L, group, data=alevinfryparr,fct=LL.2(),type="binomial")
plot(alevinfryparrdrc)
plot(alevinfryparrsepdrc)
summary(alevinfryparrdrc)
summary(alevinfryparrsepdrc)
confint(alevinfryparrsepdrc)
summary(parrdrc)
confint(parrdrc)
#combined juvenile drc
alevinfryparr<-rbind(valevin,fry,parr)
alevinfryparrdrc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L, data=alevinfryparr,fct=LL.2(),type="binomial")
alevinfryparrsepdrc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L, group, data=alevinfryparr,fct=LL.2(),type="binomial")
alevinfryparrsepdrc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L, Group, data=alevinfryparr,fct=LL.2(),type="binomial")
plot(alevinfryparrdrc)
plot(alevinfryparrsepdrc)
summary(alevinfryparrdrc)
summary(alevinfryparrsepdrc)
confint(alevinfryparrsepdrc)
anova(alevinfryparrdrc,alevinfryparrsepdrc)
#plot of alevin, fry, and parr separate models
newdata_valevindrc <- expand.grid(conca=seq(0, 1650, length=10000))
pmvalevindrc <- predict(valevindrc, newdata=newdata_valevindrc, interval="confidence")
newdata_valevindrc$p <- pmvalevindrc[,1]
newdata_valevindrc$pmin <- pmvalevindrc[,2]
newdata_valevindrc$pmax <- pmvalevindrc[,3]
newdata_frydrc <- expand.grid(conca=seq(0, 1650, length=10000))
pmfrydrc <- predict(frydrc, newdata=newdata_frydrc, interval="confidence")
newdata_frydrc$p <- pmfrydrc[,1]
newdata_frydrc$pmin <- pmfrydrc[,2]
newdata_frydrc$pmax <- pmfrydrc[,3]
newdata_parrdrc <- expand.grid(conca=seq(0, 1650, length=10000))
pmparrdrc <- predict(parrdrc, newdata=newdata_parrdrc, interval="confidence")
newdata_parrdrc$p <- pmparrdrc[,1]
newdata_parrdrc$pmin <- pmparrdrc[,2]
newdata_parrdrc$pmax <- pmparrdrc[,3]
juvplot<-ggplot(fry, aes(x = Measured_6PPDQ_ng_L, y = Mortality_Rate)) +
geom_ribbon(fill=4,color=4,data=newdata_frydrc, aes(x=conca, y=p, ymin=pmin, ymax=pmax), alpha=0.2) +
geom_line(color=4, size=1.3,data=newdata_frydrc, aes(x=conca, y=p)) +
geom_jitter(color=4, size=3, shape=3, stroke=2,width=10) +
geom_ribbon(fill=3,color=3,data=newdata_valevindrc, aes(x=conca, y=p, ymin=pmin, ymax=pmax), alpha=0.2) +
geom_line(color=3, size=1.3,data=newdata_valevindrc, aes(x=conca, y=p)) +
geom_jitter(data=valevin,color=3, size=3, shape=2, stroke=2,width=10) +
geom_ribbon(fill=8,color=8,data=newdata_parrdrc, aes(x=conca, y=p, ymin=pmin, ymax=pmax), alpha=0.2) +
geom_line(color=8, size=1.3,data=newdata_parrdrc, aes(x=conca, y=p)) +
geom_point(data=parr,color=8, size=3, shape=1, stroke=2) +
scale_y_continuous(breaks = seq(0, 1, by = 0.5))+
scale_x_continuous(breaks = seq(0, 1500, by = 500))+
coord_cartesian(ylim=c(0,1), expand = TRUE)+
labs(x="[6PPDQ] (ng/L)", y="Mortality probability")+
theme_classic(20)+
annotate("text",x=1400,y=.3,label="Parr",color=8,hjust=0, size=7)+
geom_point(x=1350,y=.3,color=8, size=3, shape=1, stroke=1) +
annotate("text",x=1400,y=.2,label="Fry",color=4,hjust=0,size=7)+
geom_point(x=1350,y=.2,color=4, size=3, shape=3, stroke=1) +
annotate("text",x=1400,y=.1,label="Alevin",color=3,hjust=0,size=7)+
geom_point(x=1350,y=.1,color=3, size=3, shape=2, stroke=1) +
coord_cartesian(ylim=c(0,1),expand=FALSE)
juvplot
require(ggplot2)
require(reshape2)
require(tidyverse)
##Load data frames
acute_data<-read.csv("data/Acute_Exposure.csv")
adult<-acute_data[acute_data$Group=="Clark Adult",]
#adult model
adult_drc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L, data=adult,fct=LL.2(),
type="binomial")
plot(adult_drc, confidence.level = 0.95)
summary(adult_drc)
confint(adult_drc)
newdata_adult_drc <- expand.grid(conca=seq(0, 400, length=10000))
pm_adult_drc <- predict(adult_drc, newdata=newdata_adult_drc,
interval="confidence", ymin=0,ymax=1)
newdata_adult_drc$p <- pm_adult_drc[,1]
newdata_adult_drc$pmin <- pm_adult_drc[,2]
newdata_adult_drc$pmax <- pm_adult_drc[,3]
#parr model
co_exposed_parr<-acute_data[acute_data$Group=="Coexposed Voights Parr",]
co_exposed_parr_drc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L,
data=co_exposed_parr, fct=LL.2(),type="binomial")
plot(co_exposed_parr_drc, confidence.level = 0.95)
summary(co_exposed_parr_drc)
confint(co_exposed_parr_drc)
newdata_co_exposed_parr_drc <- expand.grid(concp=seq(0, 400, length=10000))
pmco_exposed_parr_drc <- predict(co_exposed_parr_drc, newdata=newdata_co_exposed_parr_drc,
interval="confidence")
newdata_co_exposed_parr_drc$p <- pmco_exposed_parr_drc[,1]
newdata_co_exposed_parr_drc$pmin <- pmco_exposed_parr_drc[,2]
newdata_co_exposed_parr_drc$pmax <- pmco_exposed_parr_drc[,3]
#plot separate drcs on the same graph
adult_plot<-ggplot(adult, aes(x = Measured_6PPDQ_ng_L, y = Mortality_Rate)) +
geom_ribbon(fill=6, color=6,data=newdata_adult_drc,
aes(x=conca, y=p, ymin=pmin, ymax=pmax), alpha=0.2) +
geom_line(color=6, size=1.3,data=newdata_adult_drc, aes(x=conca, y=p)) +
geom_point(color=6, size=3, shape=2, stroke=2) +
geom_ribbon(fill=8,color=8,data=newdata_co_exposed_parr_drc,
aes(x=concp, y=p, ymin=pmin, ymax=pmax), alpha=0.2) +
geom_line(color=8, size=1.3,data=newdata_co_exposed_parr_drc,
aes(x=concp, y=p)) +
geom_point(data=co_exposed_parr,
aes(x = Measured_6PPDQ_ng_L, y = Mortality_Rate),color=8, size=3,
shape=1, stroke=2) +
labs(x="[6PPDQ] (ng/L)", y="Mortality probability")+
scale_y_continuous(breaks = seq(0, 1, by = 0.5))+
coord_cartesian(ylim=c(0,1),xlim=c(0,350),expand=FALSE)+
theme_classic(20)+
geom_point(x=250,y=0.25,color=8, size=3, shape=1, stroke=1) +
geom_point(x=250,y=0.15,color=6, size=3, shape=2, stroke=1) +
annotate("text",x=260,y=0.25,label="Parr",color=8,hjust=0, size=7,stroke=1)+
annotate("text",x=260,y=0.15,label="Adult",color=6,hjust=0,size=7,stroke=1)+
annotate("text",x=14.6,y=0.95,label="A)",size=6,hjust=0, size=8)
adult_plot
#adult and co-exposed parr combined model
adult_co_exposed_parr<-rbind(adult,co_exposed_parr)
adult_co_exposed_parr_drc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L,
data=adult_co_exposed_parr,
fct=LL.2(),type="binomial")
adult_co_exposed_parr_separate_drc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L,
Group,data=adult_co_exposed_parr,
fct=LL.2(),type="binomial")
plot(adult_co_exposed_parr_drc)
plot(adult_co_exposed_parr_separate_drc)
summary(adult_co_exposed_parr_separate_drc)
modelFit(adult_co_exposed_parr_drc)
modelFit(adult_drc)
anova(adult_co_exposed_parr_drc,adult_co_exposed_parr_separate_drc)
#adult and solo exposed parr combined model
parr<-acute_data[acute_data$Group=="Voights Parr",]
adult_parr<-rbind(adult,parr)
adult_parr_drc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L, data=adult_parr,
fct=LL.2(),type="binomial")
adult_parr_separate_drc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L,
Group,data=adult_parr,
fct=LL.2(),type="binomial")
plot(adult_parr_separate_drc)
summary(adult_parr_separate_drc)
anova(adult_parr_separate_drc,adult_parr_drc)
anova(adult_co_exposed_parr_drc,adult_co_exposed_parr_separate_drc)
require(drc)
require(ggplot2)
require(reshape2)
require(tidyverse)
require(car)
require(pwr)
valevin<-acute_data[acute_data$Group=="Voights Alevin",]
valevindrc<-drm(valevin$Mortality_Rate~valevin$Measured_6PPDQ_ng_L, fct=LL.2(),type="binomial")
plot(valevindrc, confidence.level = 0.95)
summary(valevindrc)
confint(valevindrc)
#Bingham alevin
balevin<-acute_data[acute_data$Group=="Bingham Alevin",]
balevindrc<-drm(balevin$Mortality_Rate~balevin$Measured_6PPDQ_ng_L, fct=LL.2(),type="binomial")
plot(balevindrc)
summary(balevindrc)
#Voight and Bingham combined model
balevin["group"]="bingham_alevin"
#Voight and Bingham combined model
bvalevin<-rbind(balevin,valevin)
#Voight and Bingham combined model
bvalevin<-rbind(balevin,valevin)
View(balevin)
View(valevin)
#Bingham alevin
balevin<-acute_data[acute_data$Group=="Bingham Alevin",]
balevindrc<-drm(balevin$Mortality_Rate~balevin$Measured_6PPDQ_ng_L, fct=LL.2(),type="binomial")
plot(balevindrc)
summary(balevindrc)
#Voight and Bingham combined model
bvalevin<-rbind(balevin,valevin)
bvalevindrc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L, data=bvalevin,fct=LL.2(),type="binomial")
bvsepdrc<-drm(mort~q,group, data=bvalevin,fct=LL.2(),type="binomial",
pmodels = list(~factor(group)-1, ~factor(group)-1))
bvsepdrc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L,Group, data=bvalevin,fct=LL.2(),type="binomial",
pmodels = list(~factor(group)-1, ~factor(group)-1))
bvsepdrc<-drm(Mortality_Rate~Measured_6PPDQ_ng_L,Group, data=bvalevin,fct=LL.2(),type="binomial",
pmodels = list(~factor(Group)-1, ~factor(Group)-1))
plot(bvalevindrc)
summary(bvalevindrc)
confint(bvalevindrc)
plot(bvsepdrc)
summary(bvsepdrc)
confint(bvsepdrc)
#Likelihood ratio
anova(bvsepdrc,bvalevindrc,test=)
require(drc)
require(ggplot2)
require(reshape2)
require(tidyverse)
require(car)
require(gridExtra)
loss<-read.csv("data/Concentration_Persistence.csv")
valoss<-loss[loss$group == "voights alevin",]
fryloss<-loss[loss$group == "fry",]
parrloss<-loss[loss$group == "parr",]
adultloss<-loss[loss$group == "adult",]
juvenileloss<-rbind(valoss,fryloss,parrloss)
#juvenile exposures Q persistence
juvpersistence<-ggplot(juvenileloss, aes(x =hour, y = qhq0)) +
geom_smooth(data=juvenileloss, linewidth=1.1, method="gam",
formula = y~x*I(x^(1/2)), color="#D55E00", fill="#D55E00",
alpha=0.2,level=0.95)+
geom_point(color="#D55E00", size=1, shape=19, stroke=1.4,alpha=1) +
xlab("Hours")+
ylab(bquote("[6PPDQ]/[6PPDQ]"[50]))+
scale_y_continuous(breaks = seq(0, 1, by = 0.5))+
scale_x_continuous(breaks = seq(0, 24, by = 12))+
coord_cartesian(ylim=c(0,1.1))+
theme_classic(20)
final<-(juvenileloss[juvenileloss$hour == 24,])
mean(final$qhq0)
sd(final$qhq0)
View(loss)
adultloss<-loss[loss$group == "Clarks_Adult",]
adultloss<-loss[loss$group == "Clark_Adult",]
valoss<-loss[loss$group == "Voights_Alevin",]
valoss<-loss[loss$Group == "Voights_Alevin",]
fryloss<-loss[loss$Group == "Voights_Fry",]
parrloss<-loss[loss$Group == "Voights_Parr",]
adultloss<-loss[loss$Group == "Clark_Adult",]
juvenileloss<-rbind(valoss,fryloss,parrloss)
#juvenile exposures Q persistence
juvpersistence<-ggplot(juvenileloss, aes(x =hour, y = qhq0)) +
geom_smooth(data=juvenileloss, linewidth=1.1, method="gam",
formula = y~x*I(x^(1/2)), color="#D55E00", fill="#D55E00",
alpha=0.2,level=0.95)+
geom_point(color="#D55E00", size=1, shape=19, stroke=1.4,alpha=1) +
xlab("Hours")+
ylab(bquote("[6PPDQ]/[6PPDQ]"[50]))+
scale_y_continuous(breaks = seq(0, 1, by = 0.5))+
scale_x_continuous(breaks = seq(0, 24, by = 12))+
coord_cartesian(ylim=c(0,1.1))+
theme_classic(20)
final<-(juvenileloss[juvenileloss$hour == 24,])
mean(final$qhq0)
final<-(juvenileloss[juvenileloss$Exposure_Hour == 24,])
mean(final$qhq0)
final<-(juvenileloss[juvenileloss$Exposure_Hour == 24,])
mean(final$C_C0)
sd(final$C_C0)
grid.arrange(juvpersistence,juvplot,ncol=2)
grid.arrange(juvpersistence,juvplot,ncol=2)
#adult exposures Q persistence
adultpersistence<-ggplot(adultloss, aes(x = Exposure_Hour, y = C_C0)) +
geom_smooth(data=adultloss, linewidth=1.1, method="gam",
formula = y~x*I(x^(1/2)), color="#D55E00", fill="#D55E00",
alpha=0.2)+
geom_point(color="#D55E00", size=1, shape=19, stroke=1.4,alpha=1) +
xlab("Hours")+
ylab(bquote("[6PPDQ]/[6PPDQ] "[0]))+
scale_y_continuous(breaks = seq(0, 1, by = 0.5))+
scale_x_continuous(breaks = seq(0, 24, by = 12))+
coord_cartesian(ylim=c(0,1), expand=FALSE)+
annotate("text",x=1,y=0.95,label="B)",size=6,hjust=0, size=8)+
theme_classic(20)
grid.arrange(adultplot,adultpersistence,ncol=2)
#juvenile exposures Q persistence
juvpersistence<-ggplot(juvenileloss, aes(x = Exposure_Hour, y = C_C0)) +
geom_smooth(data=juvenileloss, linewidth=1.1, method="gam",
formula = y~x*I(x^(1/2)), color="#D55E00", fill="#D55E00",
alpha=0.2,level=0.95)+
geom_point(color="#D55E00", size=1, shape=19, stroke=1.4,alpha=1) +
xlab("Hours")+
ylab(bquote("[6PPDQ]/[6PPDQ]"[50]))+
scale_y_continuous(breaks = seq(0, 1, by = 0.5))+
scale_x_continuous(breaks = seq(0, 24, by = 12))+
coord_cartesian(ylim=c(0,1.1))+
theme_classic(20)
final<-(juvenileloss[juvenileloss$Exposure_Hour == 24,])
mean(final$C_C0)
sd(final$C_C0)
grid.arrange(juvpersistence,juvplot,ncol=2)
loss<-geom_smooth(data=juvenileloss, linewidth=1.1, method="gam",
formula = y~x*I(x^(1/2)), color="#D55E00", fill="#D55E00",
alpha=0.2,level=0.95)
auc(loss,0,24)
#adult exposures Q persistence
adultpersistence<-ggplot(adultloss, aes(x = Exposure_Hour, y = C_C0)) +
geom_smooth(data=adultloss, linewidth=1.1, method="gam",
formula = y~x*I(x^(1/2)), color="#D55E00", fill="#D55E00",
alpha=0.2)+
geom_point(color="#D55E00", size=1, shape=19, stroke=1.4,alpha=1) +
xlab("Hours")+
ylab(bquote("[6PPDQ]/[6PPDQ] "[0]))+
scale_y_continuous(breaks = seq(0, 1, by = 0.5))+
scale_x_continuous(breaks = seq(0, 24, by = 12))+
coord_cartesian(ylim=c(0,1), expand=FALSE)+
annotate("text",x=1,y=0.95,label="B)",size=6,hjust=0, size=8)+
theme_classic(20)
grid.arrange(adultplot,adultpersistence,ncol=2)
adult_plot
grid.arrange(adult_plot,adultpersistence,ncol=2)
require(GGally)
require(BioRssay)
require(rgl)
require(truncnorm)
require(betareg)
require(statmod)
require(lmtest)
require(cowplot)
lcdf<-data.frame(strain=c(54,54,74,74,342,342,300,300,1095,1095),
dose=c("ED"(valevindrc,50),"ED"(frydrc,50),"ED"(parrdrc,50),
"ED"(coparrdrc,50), "ED"(adultdrc,50)))
lcdf<-data.frame(strain=c(54,54,74,74,342,342,300,300,1095,1095),
dose=c("ED"(valevindrc,50),"ED"(frydrc,50),"ED"(parrdrc,50),
"ED"(co_exposed_parr_drc,50), "ED"(adult_drc,50)))
lcs<-lcdf[c(1,3,5,7,9),]
sds<-lcdf[c(2,4,6,8,10),]
colnames(sds)<-c("strain","sd")
lcsds<-merge(lcs,sds, by="strain")
data<-read.csv("probmort.csv")
data<-read.csv("data/Acute_Exposure.csv")
View(dechor)
View(data)
model<-betareg(Mortality_Rate~I(log(Measured_6PPDQ_ng_L))*I(log(Days_Post_Fertilization)), data = data)
summary(model)
lrtest(model)
plot(model)
shapiro.test(data$mort)
matrix <- matrix(rnorm(111), nrow=111, ncol=111)
rownames(matrix) <- seq(from=0.1, to=1100.1, by=10)
colnames(matrix) <- seq(from=0.1, to=1100.1,by=10)
matrix_melted <- melt(matrix)
colnames(matrix_melted) <- c("strain", "dose", "mort")
matrix_melted$mort<-predict(model, matrix_melted)
lcsds$mort<-predict(model,lcsds)
ggplot(data=matrix_melted, aes(x=strain, y=dose, fill=(mort))) +
geom_raster(data=matrix_melted,interpolate=TRUE) +
scale_fill_binned(name="P(mort)",low="#333333",high="white",n.breaks=6,
right=FALSE,transform="sqrt") +
geom_jitter(data=data,shape=21,width=10,size=4,stroke=1.1,color="black")+
geom_point(data=lcsds,color="black",size=4)+
geom_errorbar(data=lcsds,aes(ymin=dose-sd,ymax=dose+sd),color="black")+
labs(x="Days post fertilization", y="[6PPDQ] (ng/L)") +
theme_classic(20)+
scale_y_continuous(breaks = seq(0, 1000, by = 500))+
scale_x_continuous(breaks = c(1,10,100,1000),labels=c("",10,100,1000))+
guides(x=guide_axis_logticks())+
coord_cartesian(ylim=c(0,1100),expand=FALSE)+
annotate("text",x=55,y=785,label="Alevin",color="black",hjust=-0.1,
fontface="bold",size=5)+
annotate("text",x=130,y=240,label="Fry",color="black",
fontface="bold",size=5)+
annotate("text",x=360,y=220,label="Parr",color="black",
fontface="bold",size=5)+
annotate("text",x=1075,y=141,label="Adult",color="black",hjust=1.1,
fontface="bold",size=5)+
theme(legend.position="right", legend.direction="vertical",
legend.margin=margin(grid::unit(0, "cm")),
legend.key.height=grid::unit(2,"cm"),
legend.key.width=grid::unit(0.2,"cm"))
lcdf<-data.frame(Days_Post_Fertilization=c(54,54,74,74,342,342,300,300,1095,1095),
Measured_6PPDQ_ng_L=c("ED"(valevindrc,50),"ED"(frydrc,50),"ED"(parrdrc,50),
"ED"(co_exposed_parr_drc,50), "ED"(adult_drc,50)))
lcs<-lcdf[c(1,3,5,7,9),]
sds<-lcdf[c(2,4,6,8,10),]
colnames(sds)<-c("Days_Post_Fertilization","sd")
lcsds<-merge(lcs,sds, by="Days_Post_Fertilization")
data<-read.csv("data/Acute_Exposure.csv")
model<-betareg(Mortality_Rate~I(log(Measured_6PPDQ_ng_L))*I(log(Days_Post_Fertilization)), data = data)
summary(model)
lrtest(model)
plot(model)
rownames(matrix) <- seq(from=0.1, to=1100.1, by=10)
colnames(matrix) <- seq(from=0.1, to=1100.1,by=10)
matrix_melted <- melt(matrix)
colnames(matrix_melted) <- c("Days_Post_Fertilization", "Measured_6PPDQ_ng_L", "Mortality_Rate")
matrix_melted$Mortality_Rate<-predict(model, matrix_melted)
lcsds$Mortality_Rate<-predict(model,lcsds)
ggplot(data=matrix_melted, aes(x=Days_Post_Fertilization, y=Measured_6PPDQ_ng_L, fill=(Mortality_Rate))) +
geom_raster(data=matrix_melted,interpolate=TRUE) +
scale_fill_binned(name="P(Mortality_Rate)",low="#333333",high="white",n.breaks=6,
right=FALSE,transform="sqrt") +
geom_jitter(data=data,shape=21,width=10,size=4,stroke=1.1,color="black")+
geom_point(data=lcsds,color="black",size=4)+
geom_errorbar(data=lcsds,aes(ymin=Measured_6PPDQ_ng_L-sd,ymax=Measured_6PPDQ_ng_L+sd),color="black")+
labs(x="Days post fertilization", y="[6PPDQ] (ng/L)") +
theme_classic(20)+
scale_y_continuous(breaks = seq(0, 1000, by = 500))+
scale_x_continuous(breaks = c(1,10,100,1000),labels=c("",10,100,1000))+
guides(x=guide_axis_logticks())+
coord_cartesian(ylim=c(0,1100),expand=FALSE)+
annotate("text",x=55,y=785,label="Alevin",color="black",hjust=-0.1,
fontface="bold",size=5)+
annotate("text",x=130,y=240,label="Fry",color="black",
fontface="bold",size=5)+
annotate("text",x=360,y=220,label="Parr",color="black",
fontface="bold",size=5)+
annotate("text",x=1075,y=141,label="Adult",color="black",hjust=1.1,
fontface="bold",size=5)+
theme(legend.position="right", legend.direction="vertical",
legend.margin=margin(grid::unit(0, "cm")),
legend.key.height=grid::unit(2,"cm"),
legend.key.width=grid::unit(0.2,"cm"))
